"use strict";

require("6to5/polyfill");
var Promise = require("bluebird");
module.exports = function (R) {
  var _ = R._;
  var should = R.should;
  var React = R.React;

  var _vanillaReactChildren = React.Children;

  var _patchedReactChildren = _.extend({}, React.Children, {
    getChildrenList: function (component) {
      if (null === component || !component.props || !component.props.children) {
        return [];
      }
      return React.Children.map(component.props.children, function (child) {
        return child;
      });
    },

    getDescendantsList: function (component) {
      var children = React.getChildrenList(component);
      var descendants = [];
      children.forEach(function (child) {
        descendants.push(child);
        React.Children.getDescendantsList(child).forEach(function (childDescendant) {
          return descendants.push(childDescendant);
        });
      });
      return descendants;
    },

    mapDescendants: function (component, fn) {
      return React.Children.getDescendantsList(component).map(fn);
    },

    mapTree: function (component, fn) {
      var tree = React.Children.getDescendantsList(component, fn);
      tree.unshift(component);
      return tree.map(fn);
    },

    restoreChildren: function () {
      _.extend(React, { Children: _vanillaReactChildren });
      return _vanillaReactChildren;
    },

    patchChildren: function () {
      _.extend(React, { Children: _patchedReactChildren });
      return _patchedReactChildren;
    },

    transformDescendants: function (component, fn) {
      var children = React.Children.getDescendantsList(component);
      if (children.length === 0) {
        return component;
      }
      if (component.props) {
        (function () {
          var transformChild = function (child) {
            return React.Children.transformTree(child, fn);
          };
          component.props.children = React.Children.mapDescendants(component, transformChild);
        })();
      }
      return component;
    },

    transformTree: function (component, fn) {
      return React.Children.transformDescendants(fn(component), fn);
    } });

  return _patchedReactChildren.patchChildren();
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImQ6L3dvcmtzcGFjZV9wci9yZWFjdC1yYWlscy9zcmMvUi5SZWFjdENoaWxkcmVuLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsT0FBTyxDQUFDLGVBQWUsQ0FBQyxDQUFDO0FBQ3pCLElBQU0sT0FBTyxHQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUNwQyxNQUFNLENBQUMsT0FBTyxHQUFHLFVBQVMsQ0FBQyxFQUFFO0FBQzNCLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDZCxNQUFNLE1BQU0sR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDO0FBQ3hCLE1BQU0sS0FBSyxHQUFHLENBQUMsQ0FBQyxLQUFLLENBQUM7O0FBRXRCLE1BQU0scUJBQXFCLEdBQUcsS0FBSyxDQUFDLFFBQVEsQ0FBQzs7QUFFN0MsTUFBTSxxQkFBcUIsR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxLQUFLLENBQUMsUUFBUSxFQUFFO0FBQ3pELG1CQUFlLEVBQUEsVUFBQyxTQUFTLEVBQUU7QUFDekIsVUFBRyxJQUFJLEtBQUssU0FBUyxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsUUFBUSxFQUFFO0FBQ3RFLGVBQU8sRUFBRSxDQUFDO09BQ1g7QUFDRCxhQUFPLEtBQUssQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsUUFBUSxFQUFFLFVBQUMsS0FBSztlQUFLLEtBQUs7T0FBQSxDQUFDLENBQUM7S0FDdkU7O0FBRUQsc0JBQWtCLEVBQUEsVUFBQyxTQUFTLEVBQUU7QUFDNUIsVUFBSSxRQUFRLEdBQUcsS0FBSyxDQUFDLGVBQWUsQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUNoRCxVQUFJLFdBQVcsR0FBRyxFQUFFLENBQUM7QUFDckIsY0FBUSxDQUFDLE9BQU8sQ0FBQyxVQUFDLEtBQUssRUFBSztBQUMxQixtQkFBVyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUN4QixhQUFLLENBQUMsUUFBUSxDQUFDLGtCQUFrQixDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFDLGVBQWU7aUJBQUssV0FBVyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUM7U0FBQSxDQUFDLENBQUM7T0FDMUcsQ0FBQyxDQUFDO0FBQ0gsYUFBTyxXQUFXLENBQUM7S0FDcEI7O0FBRUQsa0JBQWMsRUFBQSxVQUFDLFNBQVMsRUFBRSxFQUFFLEVBQUU7QUFDNUIsYUFBTyxLQUFLLENBQUMsUUFBUSxDQUFDLGtCQUFrQixDQUFDLFNBQVMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQztLQUM3RDs7QUFFRCxXQUFPLEVBQUEsVUFBQyxTQUFTLEVBQUUsRUFBRSxFQUFFO0FBQ3JCLFVBQUksSUFBSSxHQUFHLEtBQUssQ0FBQyxRQUFRLENBQUMsa0JBQWtCLENBQUMsU0FBUyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0FBQzVELFVBQUksQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDeEIsYUFBTyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0tBQ3JCOztBQUVELG1CQUFlLEVBQUEsWUFBRztBQUNoQixPQUFDLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxFQUFFLFFBQVEsRUFBRSxxQkFBcUIsRUFBRSxDQUFDLENBQUM7QUFDckQsYUFBTyxxQkFBcUIsQ0FBQztLQUM5Qjs7QUFFRCxpQkFBYSxFQUFBLFlBQUc7QUFDZCxPQUFDLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxFQUFFLFFBQVEsRUFBRSxxQkFBcUIsRUFBRSxDQUFDLENBQUM7QUFDckQsYUFBTyxxQkFBcUIsQ0FBQztLQUM5Qjs7QUFFRCx3QkFBb0IsRUFBQSxVQUFDLFNBQVMsRUFBRSxFQUFFLEVBQUU7QUFDbEMsVUFBSSxRQUFRLEdBQUcsS0FBSyxDQUFDLFFBQVEsQ0FBQyxrQkFBa0IsQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUM1RCxVQUFHLFFBQVEsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO0FBQ3hCLGVBQU8sU0FBUyxDQUFDO09BQ2xCO0FBQ0QsVUFBRyxTQUFTLENBQUMsS0FBSyxFQUFFOztBQUNsQixjQUFJLGNBQWMsR0FBRyxVQUFDLEtBQUs7bUJBQUssS0FBSyxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQztXQUFBLENBQUM7QUFDeEUsbUJBQVMsQ0FBQyxLQUFLLENBQUMsUUFBUSxHQUFHLEtBQUssQ0FBQyxRQUFRLENBQUMsY0FBYyxDQUFDLFNBQVMsRUFBRSxjQUFjLENBQUMsQ0FBQzs7T0FDckY7QUFDRCxhQUFPLFNBQVMsQ0FBQztLQUNsQjs7QUFFRCxpQkFBYSxFQUFBLFVBQUMsU0FBUyxFQUFFLEVBQUUsRUFBRTtBQUMzQixhQUFPLEtBQUssQ0FBQyxRQUFRLENBQUMsb0JBQW9CLENBQUMsRUFBRSxDQUFDLFNBQVMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0tBQy9ELEVBRUYsQ0FBQyxDQUFDOztBQUVILFNBQU8scUJBQXFCLENBQUMsYUFBYSxFQUFFLENBQUM7Q0FDOUMsQ0FBQyIsImZpbGUiOiJSLlJlYWN0Q2hpbGRyZW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKCc2dG81L3BvbHlmaWxsJyk7XG5jb25zdCBQcm9taXNlID0gcmVxdWlyZSgnYmx1ZWJpcmQnKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oUikge1xyXG4gIGNvbnN0IF8gPSBSLl87XHJcbiAgY29uc3Qgc2hvdWxkID0gUi5zaG91bGQ7XHJcbiAgY29uc3QgUmVhY3QgPSBSLlJlYWN0O1xyXG5cclxuICBjb25zdCBfdmFuaWxsYVJlYWN0Q2hpbGRyZW4gPSBSZWFjdC5DaGlsZHJlbjtcclxuXHJcbiAgY29uc3QgX3BhdGNoZWRSZWFjdENoaWxkcmVuID0gXy5leHRlbmQoe30sIFJlYWN0LkNoaWxkcmVuLCB7XHJcbiAgICBnZXRDaGlsZHJlbkxpc3QoY29tcG9uZW50KSB7XHJcbiAgICAgIGlmKG51bGwgPT09IGNvbXBvbmVudCB8fCAhY29tcG9uZW50LnByb3BzIHx8ICFjb21wb25lbnQucHJvcHMuY2hpbGRyZW4pIHtcclxuICAgICAgICByZXR1cm4gW107XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFJlYWN0LkNoaWxkcmVuLm1hcChjb21wb25lbnQucHJvcHMuY2hpbGRyZW4sIChjaGlsZCkgPT4gY2hpbGQpO1xyXG4gICAgfSxcclxuXHJcbiAgICBnZXREZXNjZW5kYW50c0xpc3QoY29tcG9uZW50KSB7XHJcbiAgICAgIGxldCBjaGlsZHJlbiA9IFJlYWN0LmdldENoaWxkcmVuTGlzdChjb21wb25lbnQpO1xyXG4gICAgICBsZXQgZGVzY2VuZGFudHMgPSBbXTtcclxuICAgICAgY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQpID0+IHtcclxuICAgICAgICBkZXNjZW5kYW50cy5wdXNoKGNoaWxkKTtcclxuICAgICAgICBSZWFjdC5DaGlsZHJlbi5nZXREZXNjZW5kYW50c0xpc3QoY2hpbGQpLmZvckVhY2goKGNoaWxkRGVzY2VuZGFudCkgPT4gZGVzY2VuZGFudHMucHVzaChjaGlsZERlc2NlbmRhbnQpKTtcclxuICAgICAgfSk7XHJcbiAgICAgIHJldHVybiBkZXNjZW5kYW50cztcclxuICAgIH0sXHJcblxyXG4gICAgbWFwRGVzY2VuZGFudHMoY29tcG9uZW50LCBmbikge1xyXG4gICAgICByZXR1cm4gUmVhY3QuQ2hpbGRyZW4uZ2V0RGVzY2VuZGFudHNMaXN0KGNvbXBvbmVudCkubWFwKGZuKTtcclxuICAgIH0sXHJcblxyXG4gICAgbWFwVHJlZShjb21wb25lbnQsIGZuKSB7XHJcbiAgICAgIGxldCB0cmVlID0gUmVhY3QuQ2hpbGRyZW4uZ2V0RGVzY2VuZGFudHNMaXN0KGNvbXBvbmVudCwgZm4pO1xyXG4gICAgICB0cmVlLnVuc2hpZnQoY29tcG9uZW50KTtcclxuICAgICAgcmV0dXJuIHRyZWUubWFwKGZuKTtcclxuICAgIH0sXHJcblxyXG4gICAgcmVzdG9yZUNoaWxkcmVuKCkge1xyXG4gICAgICBfLmV4dGVuZChSZWFjdCwgeyBDaGlsZHJlbjogX3ZhbmlsbGFSZWFjdENoaWxkcmVuIH0pO1xyXG4gICAgICByZXR1cm4gX3ZhbmlsbGFSZWFjdENoaWxkcmVuO1xyXG4gICAgfSxcclxuXHJcbiAgICBwYXRjaENoaWxkcmVuKCkge1xyXG4gICAgICBfLmV4dGVuZChSZWFjdCwgeyBDaGlsZHJlbjogX3BhdGNoZWRSZWFjdENoaWxkcmVuIH0pO1xyXG4gICAgICByZXR1cm4gX3BhdGNoZWRSZWFjdENoaWxkcmVuO1xyXG4gICAgfSxcclxuXHJcbiAgICB0cmFuc2Zvcm1EZXNjZW5kYW50cyhjb21wb25lbnQsIGZuKSB7XHJcbiAgICAgIGxldCBjaGlsZHJlbiA9IFJlYWN0LkNoaWxkcmVuLmdldERlc2NlbmRhbnRzTGlzdChjb21wb25lbnQpO1xyXG4gICAgICBpZihjaGlsZHJlbi5sZW5ndGggPT09IDApIHtcclxuICAgICAgICByZXR1cm4gY29tcG9uZW50O1xyXG4gICAgICB9XHJcbiAgICAgIGlmKGNvbXBvbmVudC5wcm9wcykge1xyXG4gICAgICAgIGxldCB0cmFuc2Zvcm1DaGlsZCA9IChjaGlsZCkgPT4gUmVhY3QuQ2hpbGRyZW4udHJhbnNmb3JtVHJlZShjaGlsZCwgZm4pO1xyXG4gICAgICAgIGNvbXBvbmVudC5wcm9wcy5jaGlsZHJlbiA9IFJlYWN0LkNoaWxkcmVuLm1hcERlc2NlbmRhbnRzKGNvbXBvbmVudCwgdHJhbnNmb3JtQ2hpbGQpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBjb21wb25lbnQ7XHJcbiAgICB9LFxyXG5cclxuICAgIHRyYW5zZm9ybVRyZWUoY29tcG9uZW50LCBmbikge1xyXG4gICAgICByZXR1cm4gUmVhY3QuQ2hpbGRyZW4udHJhbnNmb3JtRGVzY2VuZGFudHMoZm4oY29tcG9uZW50KSwgZm4pO1xyXG4gICAgfSxcclxuXHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiBfcGF0Y2hlZFJlYWN0Q2hpbGRyZW4ucGF0Y2hDaGlsZHJlbigpO1xyXG59O1xyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=